<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#D8B26A">
    <meta name="description" content="ATÂ·OM â€” Les 9 domaines d'expertise et 400+ agents IA">

    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/logo192.png">

    <title>ATÂ·OM | Les 9 Domaines</title>
    <script src="/config.js"></script>
    <script src="/js/governance-init.js"></script>

    <style>
        :root {
            --sacred-gold: #D8B26A;
            --dark-bg: #0a0a0f;
            --dark-surface: #1A1A1A;
            --green-glow: #00FF88;
            --phi: 1.618033988749895;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: var(--dark-bg);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           HEADER - Fixed Top
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 50;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1.5rem;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(216, 178, 106, 0.3);
        }

        .logo { display: flex; align-items: center; gap: 0.75rem; }
        .logo-icon { font-size: 1.5rem; }
        .logo-text { font-size: 1.25rem; font-weight: bold; color: var(--sacred-gold); letter-spacing: 2px; }
        .logo-subtitle { font-size: 0.7rem; color: rgba(255, 255, 255, 0.5); }

        .header-stats {
            display: flex;
            gap: 1.5rem;
            text-align: center;
        }

        .stat-box { text-align: center; }
        .stat-value { font-size: 1.25rem; color: var(--sacred-gold); font-weight: bold; }
        .stat-label { font-size: 0.65rem; color: rgba(255, 255, 255, 0.5); text-transform: uppercase; }

        .header-nav {
            display: flex;
            gap: 0.25rem;
            flex-wrap: wrap;
        }

        .header-btn.active {
            background: rgba(216, 178, 106, 0.3);
            border-color: var(--sacred-gold);
            color: var(--sacred-gold);
        }

        @media (max-width: 1100px) {
            .header-nav { display: none; }
        }

        .header-btn {
            padding: 0.5rem 1rem;
            background: rgba(128, 128, 128, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }

        .header-btn:hover {
            background: rgba(216, 178, 106, 0.2);
            border-color: var(--sacred-gold);
            color: var(--sacred-gold);
        }

        .header-btn.primary {
            background: rgba(216, 178, 106, 0.2);
            border-color: var(--sacred-gold);
            color: var(--sacred-gold);
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           MODE SWITCH - PUBLIC / AVANCE
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .mode-switch-container {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .mode-switch {
            position: relative;
            width: 120px;
            height: 32px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            cursor: pointer;
            overflow: hidden;
            transition: all 0.3s;
        }

        .mode-switch:hover {
            border-color: var(--sacred-gold);
        }

        .mode-switch-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: calc(50% - 4px);
            height: calc(100% - 4px);
            background: var(--sacred-gold);
            border-radius: 12px;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .mode-switch.advanced .mode-switch-slider {
            left: calc(50% + 2px);
            background: linear-gradient(135deg, #9333EA, #6B21A8);
        }

        .mode-switch-labels {
            position: absolute;
            display: flex;
            width: 100%;
            height: 100%;
        }

        .mode-switch-label {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.65rem;
            font-weight: bold;
            transition: color 0.3s;
            z-index: 1;
            text-transform: uppercase;
        }

        .mode-switch-label.active { color: var(--dark-bg); }
        .mode-switch-label:not(.active) { color: rgba(255, 255, 255, 0.4); }

        /* Advanced Mode Body State */
        body.advanced-mode {
            background: linear-gradient(135deg, #0a0a1a, #1a0a2a, #0a1a1a);
        }

        /* Elements hidden in public mode, shown in advanced */
        .advanced-only {
            display: none !important;
        }

        body.advanced-mode .advanced-only {
            display: flex !important;
        }

        body.advanced-mode .advanced-only.adn-card {
            display: block !important;
        }

        body.advanced-mode .advanced-only.stat-box {
            display: block !important;
        }

        body.advanced-mode .public-only {
            display: none !important;
        }

        /* Agent sphere freq badge for advanced mode */
        .agent-sphere-freq {
            font-size: 0.7rem;
            color: var(--agent-color, var(--sacred-gold));
            font-weight: bold;
            padding: 0.2rem 0.5rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           MAIN LAYOUT - 3 HUBS (Canonical Grid)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .main-content {
            padding-top: 70px;
            padding-bottom: 1rem;
            min-height: 100vh;
        }

        .grid-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem;
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        @media (min-width: 1024px) {
            .grid-container {
                grid-template-columns: 280px 1fr 320px;
            }
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           HUB 1 - LEFT: SPHERE NAVIGATOR (Collapsible)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .sphere-navigator {
            background: rgba(128, 128, 128, 0.05);
            border: 1px solid rgba(128, 128, 128, 0.2);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        /* Collapsed State - Icons Only */
        .sphere-navigator.collapsed {
            width: 70px !important;
            min-width: 70px;
        }

        .nav-header {
            padding: 1rem;
            border-bottom: 1px solid rgba(128, 128, 128, 0.2);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 0.5rem;
        }

        .nav-header h3 {
            font-size: 1rem;
            color: white;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
            overflow: hidden;
        }

        .nav-header-text {
            transition: opacity 0.2s, width 0.2s;
        }

        .sphere-navigator.collapsed .nav-header-text {
            opacity: 0;
            width: 0;
            overflow: hidden;
        }

        .nav-toggle-btn {
            width: 28px;
            height: 28px;
            min-width: 28px;
            border-radius: 6px;
            background: rgba(216, 178, 106, 0.2);
            border: 1px solid rgba(216, 178, 106, 0.3);
            color: var(--sacred-gold);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .nav-toggle-btn:hover {
            background: rgba(216, 178, 106, 0.4);
            transform: scale(1.05);
        }

        .sphere-navigator.collapsed .nav-toggle-btn {
            transform: rotate(180deg);
        }

        .sphere-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .sphere-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            cursor: pointer;
            border-bottom: 1px solid rgba(128, 128, 128, 0.1);
            transition: all 0.2s;
        }

        /* Collapsed: Center the icon */
        .sphere-navigator.collapsed .sphere-item {
            justify-content: center;
            padding: 0.75rem 0.5rem;
            gap: 0;
        }

        .sphere-item:hover {
            background: rgba(216, 178, 106, 0.1);
        }

        .sphere-item.active {
            background: rgba(216, 178, 106, 0.15);
            border-left: 3px solid var(--sacred-gold);
        }

        .sphere-navigator.collapsed .sphere-item.active {
            border-left: none;
            border-bottom: 2px solid var(--sacred-gold);
        }

        .sphere-icon-wrap {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            background: var(--sphere-bg, rgba(255,255,255,0.1));
            border: 1px solid var(--sphere-color, rgba(255,255,255,0.2));
            flex-shrink: 0;
            transition: transform 0.2s;
        }

        .sphere-navigator.collapsed .sphere-icon-wrap:hover {
            transform: scale(1.15);
        }

        .sphere-info {
            flex: 1;
            min-width: 0;
            transition: opacity 0.2s, width 0.2s;
        }

        /* Hide text content when collapsed */
        .sphere-navigator.collapsed .sphere-info,
        .sphere-navigator.collapsed .sphere-badge {
            display: none;
        }

        .sphere-name {
            font-size: 0.9rem;
            font-weight: 500;
            color: white;
        }

        .sphere-count {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.5);
        }

        .sphere-badge {
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            background: var(--sphere-color, var(--sacred-gold));
            color: black;
        }

        /* ADN Card - Hide when collapsed */
        .sphere-navigator.collapsed .adn-card {
            display: none;
        }

        /* ADN Card in Navigator */
        .adn-card {
            padding: 1rem;
            border-top: 1px solid rgba(128, 128, 128, 0.2);
            background: rgba(0, 0, 0, 0.3);
            transition: opacity 0.2s;
        }

        .adn-title {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 0.75rem;
        }

        .adn-values {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
        }

        .adn-item {
            text-align: center;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 6px;
        }

        .adn-value {
            font-size: 1rem;
            font-weight: bold;
            color: var(--sacred-gold);
        }

        .adn-label {
            font-size: 0.65rem;
            color: rgba(255, 255, 255, 0.4);
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           HUB 2 - CENTER: MAIN VISUALIZATION
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .main-visualization {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .viz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .viz-title {
            font-size: 1.1rem;
            color: var(--sacred-gold);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .viz-controls {
            display: flex;
            gap: 0.5rem;
        }

        .viz-btn {
            padding: 0.4rem 0.75rem;
            background: rgba(128, 128, 128, 0.2);
            border: 1px solid rgba(128, 128, 128, 0.3);
            color: rgba(255, 255, 255, 0.7);
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .viz-btn:hover, .viz-btn.active {
            background: rgba(216, 178, 106, 0.2);
            border-color: var(--sacred-gold);
            color: var(--sacred-gold);
        }

        /* Planet Canvas Container */
        .planet-container {
            position: relative;
            width: 100%;
            aspect-ratio: 1;
            max-width: 500px;
            margin: 0 auto;
        }

        .planet-canvas {
            width: 100%;
            height: 100%;
            cursor: crosshair;
        }

        /* Spheres Grid View */
        .spheres-grid {
            display: none;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }

        .spheres-grid.active {
            display: grid;
        }

        @media (max-width: 768px) {
            .spheres-grid { grid-template-columns: repeat(2, 1fr); }
        }

        .sphere-card {
            position: relative;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.25rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            overflow: hidden;
        }

        .sphere-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--sphere-color);
        }

        .sphere-card:hover {
            transform: translateY(-3px);
            border-color: var(--sphere-color);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .sphere-card.active {
            border-color: var(--sacred-gold);
            background: rgba(216, 178, 106, 0.1);
        }

        .sphere-card-icon { font-size: 2rem; margin-bottom: 0.5rem; }
        .sphere-card-name { font-size: 0.9rem; font-weight: 600; color: white; }
        .sphere-card-count { font-size: 1.5rem; font-weight: bold; color: var(--sphere-color); margin-top: 0.25rem; }
        .sphere-card-label { font-size: 0.7rem; color: rgba(255, 255, 255, 0.4); }

        /* XR Badge */
        .xr-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #6B21A8, #9333EA);
            border-radius: 20px;
            font-size: 0.8rem;
            margin-top: 1rem;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           HUB 3 - RIGHT: DETAILS PANEL
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .details-panel {
            background: rgba(128, 128, 128, 0.05);
            border: 1px solid rgba(128, 128, 128, 0.2);
            border-radius: 12px;
            overflow: hidden;
        }

        .panel-section {
            padding: 1rem;
            border-bottom: 1px solid rgba(128, 128, 128, 0.1);
        }

        .panel-section:last-child { border-bottom: none; }

        .panel-title {
            font-size: 0.9rem;
            color: white;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Selected Sphere Header */
        .selected-header {
            text-align: center;
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(216, 178, 106, 0.1), transparent);
        }

        .selected-icon { font-size: 3rem; margin-bottom: 0.5rem; }
        .selected-name { font-size: 1.25rem; font-weight: bold; color: var(--sacred-gold); }
        .selected-count { font-size: 0.9rem; color: rgba(255, 255, 255, 0.5); margin-top: 0.25rem; }

        /* Agent List */
        .agent-list {
            max-height: 280px;
            overflow-y: auto;
        }

        .agent-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.6rem 0.75rem;
            margin-bottom: 0.4rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
            border-left: 3px solid var(--agent-color, var(--sacred-gold));
            transition: all 0.2s;
        }

        .agent-item:hover {
            background: rgba(255, 255, 255, 0.06);
        }

        .agent-info { flex: 1; min-width: 0; }
        .agent-name { font-size: 0.85rem; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .agent-role { font-size: 0.7rem; color: rgba(255, 255, 255, 0.4); }
        .agent-freq { font-size: 0.85rem; color: var(--sacred-gold); font-weight: 500; }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
        }

        .stat-item {
            text-align: center;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
        }

        .stat-item-value { font-size: 1.1rem; font-weight: bold; color: var(--sacred-gold); }
        .stat-item-label { font-size: 0.65rem; color: rgba(255, 255, 255, 0.4); margin-top: 0.2rem; }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 2rem;
            color: rgba(255, 255, 255, 0.4);
        }

        .empty-state-icon { font-size: 2.5rem; margin-bottom: 0.5rem; opacity: 0.5; }
        .empty-state-text { font-size: 0.85rem; }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           MOBILE RESPONSIVE
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        @media (max-width: 1023px) {
            .header-stats { display: none; }

            .grid-container {
                grid-template-columns: 1fr;
            }

            .sphere-navigator {
                order: 2;
            }

            .main-visualization {
                order: 1;
            }

            .details-panel {
                order: 3;
            }

            .sphere-list { max-height: 200px; }
        }

        /* Loading Spinner */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 3rem;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(216, 178, 106, 0.2);
            border-top-color: var(--sacred-gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        /* Tooltip */
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid var(--sacred-gold);
            border-radius: 8px;
            padding: 0.75rem;
            pointer-events: none;
            z-index: 100;
            transform: translate(-50%, -100%);
            margin-top: -10px;
        }

        .tooltip-name { font-size: 0.9rem; color: var(--sacred-gold); font-weight: bold; }
        .tooltip-count { font-size: 0.75rem; color: rgba(255, 255, 255, 0.6); }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           FLOATING AGENT TOGGLE - AMOVIBLE (Draggable)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .agent-fab {
            position: fixed;
            bottom: 100px;
            right: 24px;
            z-index: 1000;
            cursor: grab;
            touch-action: none;
            user-select: none;
        }

        .agent-fab.dragging {
            cursor: grabbing;
        }

        .fab-main {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--sacred-gold), #8B6914);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 20px rgba(216, 178, 106, 0.4);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .fab-main:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(216, 178, 106, 0.6);
        }

        .fab-main.open {
            transform: rotate(45deg);
        }

        /* Agent Sphere Buttons */
        .agent-spheres {
            position: absolute;
            bottom: 70px;
            right: 0;
            display: flex;
            flex-direction: column;
            gap: 12px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }

        .agent-fab.open .agent-spheres {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .agent-sphere {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 16px 8px 10px;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid var(--agent-color, rgba(255, 255, 255, 0.2));
            border-radius: 28px;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .agent-sphere:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(-5px);
        }

        .agent-sphere-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            background: var(--agent-bg, rgba(255, 255, 255, 0.1));
            border: 2px solid var(--agent-color);
        }

        .agent-sphere-info {
            flex: 1;
        }

        .agent-sphere-name {
            font-size: 0.85rem;
            font-weight: 600;
            color: white;
        }

        .agent-sphere-role {
            font-size: 0.65rem;
            color: rgba(255, 255, 255, 0.5);
        }

        .agent-sphere-freq {
            font-size: 0.7rem;
            color: var(--agent-color);
            font-weight: bold;
        }

        /* Quick Connect Button */
        .quick-connect {
            --agent-color: var(--sacred-gold);
            border-style: dashed;
        }

        .quick-connect .agent-sphere-icon {
            font-size: 1.5rem;
            background: transparent;
        }

        /* Agent Chat Panel */
        .agent-chat-panel {
            position: fixed;
            bottom: 100px;
            right: 24px;
            width: 350px;
            max-height: 500px;
            background: rgba(10, 10, 15, 0.98);
            border: 1px solid rgba(216, 178, 106, 0.3);
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            display: none;
            flex-direction: column;
            overflow: hidden;
            z-index: 1001;
        }

        .agent-chat-panel.open {
            display: flex;
        }

        .chat-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: rgba(0, 0, 0, 0.5);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chat-agent-icon {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background: var(--agent-bg);
            border: 2px solid var(--agent-color);
        }

        .chat-agent-info {
            flex: 1;
        }

        .chat-agent-name {
            font-size: 1rem;
            font-weight: bold;
            color: white;
        }

        .chat-agent-status {
            font-size: 0.75rem;
            color: var(--green-glow);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .chat-agent-status::before {
            content: '';
            width: 6px;
            height: 6px;
            background: var(--green-glow);
            border-radius: 50%;
        }

        .chat-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-messages {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
            max-height: 300px;
        }

        .chat-message {
            margin-bottom: 12px;
            padding: 10px 14px;
            border-radius: 12px;
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .chat-message.agent {
            background: rgba(255, 255, 255, 0.05);
            border-left: 3px solid var(--agent-color);
            color: white;
        }

        .chat-message.user {
            background: rgba(216, 178, 106, 0.2);
            text-align: right;
            color: white;
        }

        .chat-input-area {
            padding: 12px 16px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 10px 14px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            color: white;
            font-size: 0.85rem;
            outline: none;
        }

        .chat-input:focus {
            border-color: var(--sacred-gold);
        }

        .chat-send {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--sacred-gold);
            border: none;
            color: black;
            cursor: pointer;
            font-size: 1rem;
        }

        @media (max-width: 480px) {
            .agent-chat-panel {
                width: calc(100% - 48px);
                right: 24px;
                left: 24px;
            }
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ENVIRONMENT CREATION MODAL
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .env-modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .env-modal-overlay.open { display: flex; }

        .env-modal {
            width: 100%;
            max-width: 560px;
            background: #111118;
            border: 1px solid rgba(216, 178, 106, 0.3);
            border-radius: 20px;
            overflow: hidden;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .env-modal-header {
            padding: 1.5rem 2rem;
            background: linear-gradient(135deg, var(--env-color, var(--sacred-gold)), transparent);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .env-modal-header h2 {
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .env-modal-close {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .env-modal-body { padding: 2rem; }

        .env-form-group {
            margin-bottom: 1.5rem;
        }

        .env-form-label {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 0.5rem;
            display: block;
        }

        .env-form-input {
            width: 100%;
            padding: 0.85rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            color: white;
            font-size: 0.95rem;
        }

        .env-form-input:focus {
            outline: none;
            border-color: var(--sacred-gold);
        }

        .env-form-textarea {
            width: 100%;
            padding: 0.85rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            color: white;
            font-size: 0.95rem;
            resize: vertical;
            min-height: 80px;
            font-family: inherit;
        }

        .env-form-textarea:focus {
            outline: none;
            border-color: var(--sacred-gold);
        }

        .env-types {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            margin-bottom: 0.25rem;
        }

        .env-type-option {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .env-type-option:hover {
            border-color: rgba(216, 178, 106, 0.4);
        }

        .env-type-option.selected {
            border-color: var(--sacred-gold);
            background: rgba(216, 178, 106, 0.1);
        }

        .env-type-icon {
            font-size: 1.3rem;
        }

        .env-type-name {
            font-size: 0.8rem;
            font-weight: 600;
            color: white;
        }

        .env-type-desc {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.5);
            line-height: 1.3;
        }

        .env-zones {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .env-zone-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .env-zone-option:hover {
            border-color: rgba(216, 178, 106, 0.4);
        }

        .env-zone-option.selected {
            border-color: var(--sacred-gold);
            background: rgba(216, 178, 106, 0.1);
            color: white;
        }

        .env-zone-check {
            width: 18px;
            height: 18px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            flex-shrink: 0;
        }

        .env-zone-option.selected .env-zone-check {
            background: var(--sacred-gold);
            border-color: var(--sacred-gold);
            color: black;
        }

        .env-modal-footer {
            padding: 1.5rem 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .env-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .env-btn-cancel {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
        }

        .env-btn-cancel:hover { background: rgba(255, 255, 255, 0.15); }

        .env-btn-create {
            background: linear-gradient(135deg, var(--sacred-gold), #c9a55a);
            color: #0a0a0f;
        }

        .env-btn-create:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(216, 178, 106, 0.4);
        }

        .env-success {
            display: none;
            text-align: center;
            padding: 2rem;
        }

        .env-success.show { display: block; }

        .env-success-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .env-success-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .env-success-text {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
            line-height: 1.5;
        }

        /* Create Env Button in Details Panel */
        .btn-create-env {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            width: 100%;
            padding: 0.85rem;
            margin-top: 1rem;
            background: linear-gradient(135deg, var(--sacred-gold), #c9a55a);
            color: #0a0a0f;
            border: none;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-create-env:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(216, 178, 106, 0.4);
        }
    </style>
</head>
<body>
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         HEADER
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <header class="header">
        <a href="/" class="logo" style="text-decoration: none;">
            <span class="logo-icon">ğŸ”±</span>
            <div>
                <div class="logo-text">ATÂ·OM</div>
                <div class="logo-subtitle">Les 9 Domaines</div>
            </div>
        </a>

        <div class="header-stats">
            <div class="stat-box">
                <div class="stat-value" id="totalAgents">--</div>
                <div class="stat-label">Agents</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">9</div>
                <div class="stat-label">Domaines</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" style="color: #00FF88;">Actif</div>
                <div class="stat-label">Statut</div>
            </div>
        </div>


        <nav class="header-nav">
            <a href="/" class="header-btn">ğŸ  Accueil</a>
            <a href="/civilization.html" class="header-btn active">ğŸŒ Domaines</a>
            <a href="/agents.html" class="header-btn">ğŸ¤– Agents</a>
            <a href="/spheres.html" class="header-btn">ğŸ”® Vue d'ensemble</a>
            <a href="/live.html" class="header-btn">âš¡ ActivitÃ©</a>
            <a href="/dashboard.html" class="header-btn">ğŸ“Š Tableau de bord</a>
            <a href="/funder.html" class="header-btn primary">ğŸ’ Partenaire</a>
        </nav>
    </header>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         MAIN CONTENT - 3 HUBS LAYOUT
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <main class="main-content">
        <div class="grid-container">

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 HUB 1 - LEFT: SPHERE NAVIGATOR (Collapsible)
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <aside class="sphere-navigator" id="sphereNavigator">
                <div class="nav-header">
                    <h3>
                        <span>ğŸŒ</span>
                        <span class="nav-header-text">Domaines</span>
                    </h3>
                    <button class="nav-toggle-btn" id="navToggleBtn" onclick="toggleSphereNavigator()" title="RÃ©duire/Agrandir">
                        â—€
                    </button>
                </div>

                <div class="sphere-list" id="sphereList">
                    <!-- Spheres will be rendered here -->
                </div>

                <!-- System Stats Card -->
                <div class="adn-card">
                    <div class="adn-title">Vue rapide</div>
                    <div class="adn-values">
                        <div class="adn-item">
                            <div class="adn-value">9</div>
                            <div class="adn-label">DOMAINES</div>
                        </div>
                        <div class="adn-item">
                            <div class="adn-value" style="color: #00FF88;">400+</div>
                            <div class="adn-label">AGENTS</div>
                        </div>
                        <div class="adn-item">
                            <div class="adn-value" style="color: #9333EA;">3</div>
                            <div class="adn-label">ASSISTANTS</div>
                        </div>
                        <div class="adn-item">
                            <div class="adn-value" style="color: #00FF88;">â—</div>
                            <div class="adn-label">EN LIGNE</div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 HUB 2 - CENTER: MAIN VISUALIZATION
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section class="main-visualization">
                <div class="viz-header">
                    <div class="viz-title">
                        <span>ğŸ—ºï¸</span>
                        <span>Mapping AT-OM</span>
                    </div>
                    <div class="viz-controls">
                        <button class="viz-btn active" data-view="planet" onclick="setView('planet')">Planet</button>
                        <button class="viz-btn" data-view="grid" onclick="setView('grid')">Grille</button>
                    </div>
                </div>

                <!-- Planet View -->
                <div class="planet-container" id="planetView">
                    <canvas class="planet-canvas" id="planetCanvas"></canvas>
                    <div class="tooltip" id="tooltip" style="display: none;"></div>
                </div>

                <!-- Grid View -->
                <div class="spheres-grid" id="gridView">
                    <!-- Sphere cards will be rendered here -->
                </div>

                <div style="text-align: center; margin-top: 0.5rem;">
                    <p style="font-size: 0.85rem; color: rgba(255,255,255,0.5); line-height: 1.5;">
                        Cliquez sur un domaine dans le menu de gauche ou sur la grille pour explorer ses agents.
                    </p>
                </div>
            </section>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 HUB 3 - RIGHT: DETAILS PANEL
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <aside class="details-panel">
                <!-- Selected Sphere -->
                <div id="selectedSphereContainer">
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ‘ˆ</div>
                        <div class="empty-state-text">Choisissez un domaine Ã  gauche<br>pour dÃ©couvrir ses agents spÃ©cialisÃ©s</div>
                        <p style="font-size:0.75rem;color:rgba(255,255,255,0.3);margin-top:0.75rem;">Chaque domaine contient des dizaines d'agents prÃªts Ã  vous assister.</p>
                    </div>
                </div>

                <!-- Global Stats -->
                <div class="panel-section">
                    <div class="panel-title"><span>ğŸ“Š</span> Statistiques</div>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-item-value" id="statPersonal">45</div>
                            <div class="stat-item-label">Personnel</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-item-value" id="statBusiness">55</div>
                            <div class="stat-item-label">Business</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-item-value" id="statCreative">50</div>
                            <div class="stat-item-label">Creatif</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-item-value" id="statSocial">45</div>
                            <div class="stat-item-label">Social</div>
                        </div>
                    </div>
                </div>
            </aside>

        </div>
    </main>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         FLOATING AGENT TOGGLE - AMOVIBLE (Nova, Aria, Orion + Quick Connect)
         MODE PUBLIC: Roles executifs/operationnels
         MODE AVANCE: Roles vibrationnels (visible uniquement en mode avance)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="agent-fab" id="agentFab">
        <div class="agent-spheres">
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 MODE PUBLIC - Executif/Operationnel
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- Nova - PUBLIC -->
            <div class="agent-sphere public-only" onclick="openAgentChat('nova')" style="--agent-color: #9333EA; --agent-bg: rgba(147, 51, 234, 0.2);">
                <div class="agent-sphere-icon">ğŸ”±</div>
                <div class="agent-sphere-info">
                    <div class="agent-sphere-name">Nova</div>
                    <div class="agent-sphere-role">Superviseur Systeme</div>
                </div>
            </div>

            <!-- Aria - PUBLIC -->
            <div class="agent-sphere public-only" onclick="openAgentChat('aria')" style="--agent-color: #00FF88; --agent-bg: rgba(0, 255, 136, 0.2);">
                <div class="agent-sphere-icon">âœ¨</div>
                <div class="agent-sphere-info">
                    <div class="agent-sphere-name">Aria</div>
                    <div class="agent-sphere-role">Guide d'Accueil</div>
                </div>
            </div>

            <!-- Orion - PUBLIC -->
            <div class="agent-sphere public-only" onclick="openAgentChat('orion')" style="--agent-color: #FF6B35; --agent-bg: rgba(255, 107, 53, 0.2);">
                <div class="agent-sphere-icon">ğŸ›ï¸</div>
                <div class="agent-sphere-info">
                    <div class="agent-sphere-name">Orion</div>
                    <div class="agent-sphere-role">Votre Coordinateur</div>
                </div>
            </div>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 MODE AVANCE - Vibrationnel/Spirituel
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- Nova - AVANCE -->
            <div class="agent-sphere" onclick="openAgentChat('nova')" style="--agent-color: #9333EA; --agent-bg: rgba(147, 51, 234, 0.2);">
                <div class="agent-sphere-icon">ğŸ”±</div>
                <div class="agent-sphere-info">
                    <div class="agent-sphere-name">Nova</div>
                    <div class="agent-sphere-role">Superviseur AvancÃ©</div>
                </div>
            </div>

            <!-- Aria - AVANCE -->
            <div class="agent-sphere" onclick="openAgentChat('aria')" style="--agent-color: #00FF88; --agent-bg: rgba(0, 255, 136, 0.2);">
                <div class="agent-sphere-icon">âœ¨</div>
                <div class="agent-sphere-info">
                    <div class="agent-sphere-name">Aria</div>
                    <div class="agent-sphere-role">Guide AvancÃ©</div>
                </div>
            </div>

            <!-- Orion - AVANCE -->
            <div class="agent-sphere" onclick="openAgentChat('orion')" style="--agent-color: #FF6B35; --agent-bg: rgba(255, 107, 53, 0.2);">
                <div class="agent-sphere-icon">ğŸ›ï¸</div>
                <div class="agent-sphere-info">
                    <div class="agent-sphere-name">Orion</div>
                    <div class="agent-sphere-role">Coordinateur AvancÃ©</div>
                </div>
            </div>

            <!-- Quick Connect - BOTH MODES -->
            <div class="agent-sphere quick-connect" onclick="openQuickConnect()">
                <div class="agent-sphere-icon">+</div>
                <div class="agent-sphere-info">
                    <div class="agent-sphere-name">Quick Connect</div>
                    <div class="agent-sphere-role">Ajouter un agent</div>
                </div>
            </div>
        </div>

        <button class="fab-main" id="fabMain" onclick="toggleAgentFab()">
            <span id="fabIcon">ğŸ’«</span>
        </button>
    </div>

    <!-- Agent Chat Panel -->
    <div class="agent-chat-panel" id="agentChatPanel">
        <div class="chat-header" id="chatHeader">
            <div class="chat-agent-icon" id="chatAgentIcon">ğŸ”±</div>
            <div class="chat-agent-info">
                <div class="chat-agent-name" id="chatAgentName">Nova</div>
                <div class="chat-agent-status">En ligne</div>
            </div>
            <button class="chat-close" onclick="closeAgentChat()">Ã—</button>
        </div>
        <div class="chat-messages" id="chatMessages">
            <!-- Messages will be rendered here -->
        </div>
        <div class="chat-input-area">
            <input type="text" class="chat-input" id="chatInput" placeholder="Message..." onkeypress="handleChatKeypress(event)">
            <button class="chat-send" onclick="sendChatMessage()">â†’</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         ENVIRONMENT CREATION MODAL
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="env-modal-overlay" id="envModal">
        <div class="env-modal">
            <div class="env-modal-header" id="envModalHeader">
                <h2><span id="envModalIcon"></span> CrÃ©er un environnement</h2>
                <button class="env-modal-close" onclick="closeEnvModal()">&times;</button>
            </div>

            <div id="envFormContent">
                <div class="env-modal-body">
                    <div class="env-form-group">
                        <label class="env-form-label">Nom de votre cause ou projet</label>
                        <input type="text" class="env-form-input" id="envName" placeholder="Ex: Transition Ã©cologique de mon quartier">
                    </div>

                    <div class="env-form-group">
                        <label class="env-form-label">DÃ©crivez votre objectif</label>
                        <textarea class="env-form-textarea" id="envDescription" placeholder="Que voulez-vous accomplir avec cet environnement ?"></textarea>
                    </div>

                    <div class="env-form-group">
                        <label class="env-form-label">Type d'environnement</label>
                        <div class="env-types" id="envTypes">
                            <!-- Populated dynamically per domain -->
                        </div>
                    </div>

                    <div class="env-form-group">
                        <label class="env-form-label">Zones actives de l'environnement</label>
                        <div class="env-zones" id="envZones">
                            <div class="env-zone-option selected" data-zone="intent" onclick="toggleZone(this)">
                                <div class="env-zone-check">âœ“</div>
                                <span>Objectifs</span>
                            </div>
                            <div class="env-zone-option selected" data-zone="action" onclick="toggleZone(this)">
                                <div class="env-zone-check">âœ“</div>
                                <span>Actions</span>
                            </div>
                            <div class="env-zone-option selected" data-zone="decision" onclick="toggleZone(this)">
                                <div class="env-zone-check">âœ“</div>
                                <span>DÃ©cisions</span>
                            </div>
                            <div class="env-zone-option" data-zone="memory" onclick="toggleZone(this)">
                                <div class="env-zone-check">âœ“</div>
                                <span>MÃ©moire</span>
                            </div>
                            <div class="env-zone-option" data-zone="timeline" onclick="toggleZone(this)">
                                <div class="env-zone-check">âœ“</div>
                                <span>Chronologie</span>
                            </div>
                            <div class="env-zone-option" data-zone="resources" onclick="toggleZone(this)">
                                <div class="env-zone-check">âœ“</div>
                                <span>Ressources</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="env-modal-footer">
                    <button class="env-btn env-btn-cancel" onclick="closeEnvModal()">Annuler</button>
                    <button class="env-btn env-btn-create" onclick="createEnvironment()">CrÃ©er l'environnement â†’</button>
                </div>
            </div>

            <div class="env-success" id="envSuccess">
                <div class="env-success-icon">âœ…</div>
                <div class="env-success-title" id="envSuccessTitle">Environnement crÃ©Ã© !</div>
                <p class="env-success-text" id="envSuccessText"></p>
                <div class="env-modal-footer" style="justify-content: center; border: none;">
                    <button class="env-btn env-btn-create" onclick="closeEnvModal()">Fermer</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // CONFIGURATION - 9 SPHERES DE LA CIVILISATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        const CIVILIZATION_SPHERES = {
            personal:      { icon: 'ğŸ‘¤', name: 'Personnel', color: '#4A90D9', count: 45 },
            business:      { icon: 'ğŸ’¼', name: 'Business', color: '#50C878', count: 55 },
            government:    { icon: 'ğŸ›ï¸', name: 'Gouvernement', color: '#9B59B6', count: 35 },
            creative:      { icon: 'ğŸ¨', name: 'Creatif', color: '#F39C12', count: 50 },
            community:     { icon: 'ğŸ‘¥', name: 'Communaute', color: '#E74C3C', count: 40 },
            social:        { icon: 'ğŸŒ', name: 'Social', color: '#1ABC9C', count: 45 },
            education:     { icon: 'ğŸ“š', name: 'Education', color: '#8E44AD', count: 50 },
            transport:     { icon: 'ğŸš€', name: 'Transport', color: '#27AE60', count: 45 },
            environment:   { icon: 'ğŸŒ±', name: 'Environnement', color: '#2ECC71', count: 35 }
        };

        let allAgents = [];
        let selectedSphere = null;
        let currentView = 'planet';
        let spherePositions = [];

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // INITIALIZATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        document.addEventListener('DOMContentLoaded', async () => {
            await loadAgents();
            renderSphereList();
            renderSphereGrid();
            initPlanetCanvas();
            updateStats();
        });

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // LOAD AGENTS FROM API (uses config.js getAgents)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        async function loadAgents() {
            try {
                const result = await getAgents();
                allAgents = result.agents;
                console.log(`[CIVILIZATION] Loaded ${allAgents.length} agents (${result.source})`);
            } catch (error) {
                console.warn('[CIVILIZATION] Using generated agents');
                allAgents = generateFallbackAgents();
            }
        }

        function generateFallbackAgents() {
            const agents = [];
            let id = 1;
            const levels = ['L0', 'L1', 'L2', 'L2', 'L3', 'L3'];
            Object.entries(CIVILIZATION_SPHERES).forEach(([key, sphere]) => {
                for (let i = 0; i < sphere.count; i++) {
                    agents.push({
                        id: id++,
                        name: `${sphere.name} Agent #${i + 1}`,
                        sphere: sphere.name,
                        sphere_key: key,
                        level: levels[i % levels.length],
                        status: 'active'
                    });
                }
            });
            return agents;
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // RENDER SPHERE LIST (LEFT NAVIGATOR)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function renderSphereList() {
            const list = document.getElementById('sphereList');
            list.innerHTML = '';

            Object.entries(CIVILIZATION_SPHERES).forEach(([key, sphere]) => {
                const count = getSphereAgentCount(key);
                const item = document.createElement('div');
                item.className = 'sphere-item';
                item.dataset.sphere = key;
                item.style.setProperty('--sphere-color', sphere.color);
                item.style.setProperty('--sphere-bg', `${sphere.color}20`);

                item.innerHTML = `
                    <div class="sphere-icon-wrap">
                        ${sphere.icon}
                    </div>
                    <div class="sphere-info">
                        <div class="sphere-name">${sphere.name}</div>
                        <div class="sphere-count">${count} agents</div>
                    </div>
                    <div class="sphere-badge" style="background: ${sphere.color};">${count}</div>
                `;

                item.addEventListener('click', () => selectSphere(key));
                list.appendChild(item);
            });
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // RENDER SPHERE GRID (CENTER ALTERNATE VIEW)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function renderSphereGrid() {
            const grid = document.getElementById('gridView');
            grid.innerHTML = '';

            Object.entries(CIVILIZATION_SPHERES).forEach(([key, sphere]) => {
                const count = getSphereAgentCount(key);
                const card = document.createElement('div');
                card.className = 'sphere-card';
                card.style.setProperty('--sphere-color', sphere.color);
                card.dataset.sphere = key;

                card.innerHTML = `
                    <div class="sphere-card-icon">${sphere.icon}</div>
                    <div class="sphere-card-name">${sphere.name}</div>
                    <div class="sphere-card-count">${count}</div>
                    <div class="sphere-card-label">agents</div>
                `;

                card.addEventListener('click', () => selectSphere(key));
                grid.appendChild(card);
            });
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // PLANET CANVAS (CENTER MAIN VIEW)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function initPlanetCanvas() {
            const canvas = document.getElementById('planetCanvas');
            const ctx = canvas.getContext('2d');
            let rotation = 0;
            let animationId = null;

            function resize() {
                const rect = canvas.parentElement.getBoundingClientRect();
                canvas.width = rect.width * 2;
                canvas.height = rect.height * 2;
            }

            resize();
            window.addEventListener('resize', resize);

            // Calculate sphere positions
            const sphereKeys = Object.keys(CIVILIZATION_SPHERES);
            spherePositions = sphereKeys.map((key, i) => {
                const phi = Math.acos(1 - 2 * (i + 0.5) / sphereKeys.length);
                const theta = Math.PI * (1 + Math.sqrt(5)) * (i + 0.5);
                return {
                    key,
                    sphere: CIVILIZATION_SPHERES[key],
                    x: Math.sin(phi) * Math.cos(theta),
                    y: Math.sin(phi) * Math.sin(theta),
                    z: Math.cos(phi)
                };
            });

            function draw() {
                const w = canvas.width;
                const h = canvas.height;
                const cx = w / 2;
                const cy = h / 2;
                const radius = Math.min(w, h) * 0.35;

                ctx.clearRect(0, 0, w, h);

                // Stars
                for (let i = 0; i < 80; i++) {
                    const x = (Math.sin(i * 127.1) * 0.5 + 0.5) * w;
                    const y = (Math.cos(i * 311.7) * 0.5 + 0.5) * h;
                    const alpha = 0.1 + Math.sin(Date.now() / 1000 + i) * 0.05;
                    ctx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
                    ctx.beginPath();
                    ctx.arc(x, y, 1, 0, Math.PI * 2);
                    ctx.fill();
                }

                // Grid lines
                ctx.strokeStyle = 'rgba(212, 175, 55, 0.08)';
                ctx.lineWidth = 1;

                for (let i = 0; i < 12; i++) {
                    const angle = (i / 12) * Math.PI * 2 + rotation;
                    ctx.beginPath();
                    for (let j = 0; j <= 32; j++) {
                        const phi = (j / 32) * Math.PI;
                        const x = cx + Math.sin(phi) * Math.cos(angle) * radius;
                        const y = cy + Math.cos(phi) * radius;
                        if (j === 0) ctx.moveTo(x, y);
                        else ctx.lineTo(x, y);
                    }
                    ctx.stroke();
                }

                // Planet glow
                const gradient = ctx.createRadialGradient(cx, cy, 0, cx, cy, radius);
                gradient.addColorStop(0, 'rgba(30, 58, 138, 0.2)');
                gradient.addColorStop(0.6, 'rgba(30, 58, 138, 0.05)');
                gradient.addColorStop(1, 'transparent');
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(cx, cy, radius, 0, Math.PI * 2);
                ctx.fill();

                // Sphere points
                spherePositions.forEach((pos, i) => {
                    const rx = pos.x * Math.cos(rotation) - pos.y * Math.sin(rotation);
                    const ry = pos.x * Math.sin(rotation) + pos.y * Math.cos(rotation);
                    const z = pos.z;

                    if (z > -0.3) {
                        const sx = cx + rx * radius;
                        const sy = cy + z * radius;
                        const scale = (ry + 1) / 2;
                        const pointRadius = 6 + scale * 10;
                        const alpha = 0.5 + scale * 0.5;

                        const isSelected = selectedSphere === pos.key;

                        // Glow
                        const glow = ctx.createRadialGradient(sx, sy, 0, sx, sy, pointRadius * 3);
                        glow.addColorStop(0, isSelected ? 'rgba(255,255,255,0.8)' : `${pos.sphere.color}${Math.round(alpha * 255).toString(16).padStart(2, '0')}`);
                        glow.addColorStop(0.5, `${pos.sphere.color}40`);
                        glow.addColorStop(1, 'transparent');
                        ctx.fillStyle = glow;
                        ctx.beginPath();
                        ctx.arc(sx, sy, pointRadius * 3, 0, Math.PI * 2);
                        ctx.fill();

                        // Point
                        ctx.fillStyle = isSelected ? '#FFFFFF' : pos.sphere.color;
                        ctx.beginPath();
                        ctx.arc(sx, sy, pointRadius, 0, Math.PI * 2);
                        ctx.fill();

                        // Store screen position for hover
                        pos.screenX = sx / 2;
                        pos.screenY = sy / 2;
                        pos.screenRadius = pointRadius;
                    }
                });

                rotation += 0.003;
                animationId = requestAnimationFrame(draw);
            }

            draw();

            // Mouse interaction
            canvas.addEventListener('mousemove', (e) => {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                let found = null;
                for (const pos of spherePositions) {
                    if (pos.screenX && pos.screenY) {
                        const dist = Math.sqrt(Math.pow(x - pos.screenX, 2) + Math.pow(y - pos.screenY, 2));
                        if (dist < pos.screenRadius + 15) {
                            found = pos;
                            break;
                        }
                    }
                }

                const tooltip = document.getElementById('tooltip');
                if (found) {
                    tooltip.style.display = 'block';
                    tooltip.style.left = found.screenX + 'px';
                    tooltip.style.top = found.screenY + 'px';
                    tooltip.innerHTML = `
                        <div class="tooltip-name">${found.sphere.icon} ${found.sphere.name}</div>
                        <div class="tooltip-count">${getSphereAgentCount(found.key)} agents</div>
                    `;
                    canvas.style.cursor = 'pointer';
                } else {
                    tooltip.style.display = 'none';
                    canvas.style.cursor = 'crosshair';
                }
            });

            canvas.addEventListener('click', (e) => {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                for (const pos of spherePositions) {
                    if (pos.screenX && pos.screenY) {
                        const dist = Math.sqrt(Math.pow(x - pos.screenX, 2) + Math.pow(y - pos.screenY, 2));
                        if (dist < pos.screenRadius + 15) {
                            selectSphere(pos.key);
                            break;
                        }
                    }
                }
            });

            canvas.addEventListener('mouseleave', () => {
                document.getElementById('tooltip').style.display = 'none';
            });
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // VIEW TOGGLE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function setView(view) {
            currentView = view;

            document.querySelectorAll('.viz-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.view === view);
            });

            document.getElementById('planetView').style.display = view === 'planet' ? 'block' : 'none';
            document.getElementById('gridView').classList.toggle('active', view === 'grid');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // SELECT SPHERE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function selectSphere(key) {
            selectedSphere = key;
            const sphere = CIVILIZATION_SPHERES[key];
            const agents = getSphereAgents(key).slice(0, 15);

            // Update navigator active state
            document.querySelectorAll('.sphere-item').forEach(item => {
                item.classList.toggle('active', item.dataset.sphere === key);
            });

            // Update grid active state
            document.querySelectorAll('.sphere-card').forEach(card => {
                card.classList.toggle('active', card.dataset.sphere === key);
            });

            // Render details panel
            const container = document.getElementById('selectedSphereContainer');
            container.innerHTML = `
                <div class="selected-header" style="background: linear-gradient(135deg, ${sphere.color}20, transparent);">
                    <div class="selected-icon">${sphere.icon}</div>
                    <div class="selected-name" style="color: ${sphere.color};">${sphere.name}</div>
                    <div class="selected-count">${agents.length} agents actifs</div>
                    <button class="btn-create-env" onclick="openEnvModal('${key}')">
                        + CrÃ©er un environnement dÃ©diÃ©
                    </button>
                </div>
                <div class="panel-section">
                    <div class="panel-title"><span>ğŸ¤–</span> Agents</div>
                    <div class="agent-list">
                        ${agents.map(a => `
                            <div class="agent-item" style="--agent-color: ${sphere.color};">
                                <div class="agent-info">
                                    <div class="agent-name">${a.name}</div>
                                    <div class="agent-role">${a.sphere || sphere.name}</div>
                                </div>
                                <div class="agent-freq" style="color: #00FF88;">Actif</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // HELPER FUNCTIONS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function getSphereAgentCount(key) {
            const sphere = CIVILIZATION_SPHERES[key];
            const count = allAgents.filter(a =>
                a.sphere_key === key ||
                a.sphere?.toLowerCase() === sphere.name.toLowerCase()
            ).length;
            return count || sphere.count;
        }

        function getSphereAgents(key) {
            const sphere = CIVILIZATION_SPHERES[key];
            let agents = allAgents.filter(a =>
                a.sphere_key === key ||
                a.sphere?.toLowerCase() === sphere.name.toLowerCase()
            );

            // Fallback if no agents from API
            if (agents.length === 0) {
                agents = [];
                for (let i = 0; i < sphere.count; i++) {
                    agents.push({
                        id: i,
                        name: `${sphere.name} Agent #${i + 1}`,
                        sphere: sphere.name,
                        level: ['L1', 'L2', 'L2', 'L3'][i % 4]
                    });
                }
            }

            return agents;
        }

        function updateStats() {
            const total = allAgents.length || Object.values(CIVILIZATION_SPHERES).reduce((sum, s) => sum + s.count, 0);
            const activeCount = allAgents.filter(a => a.status === 'active' || !a.status).length;
            const activePercent = total > 0 ? Math.round((activeCount / total) * 100) : 0;

            document.getElementById('totalAgents').textContent = total;
            document.getElementById('avgFreq').textContent = activePercent + '%';

            document.getElementById('statPersonal').textContent = getSphereAgentCount('personal');
            document.getElementById('statBusiness').textContent = getSphereAgentCount('business');
            document.getElementById('statCreative').textContent = getSphereAgentCount('creative');
            document.getElementById('statSocial').textContent = getSphereAgentCount('social');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // FLOATING AGENT TOGGLE - AMOVIBLE (Draggable)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        const CORE_AGENTS = {
            nova: {
                id: 'nova',
                name: 'Nova',
                icon: 'ğŸ”±',
                title: 'Superviseur Systeme',
                level: 'Expert',
                color: '#9333EA',
                personality: 'calm, wise, protective',
                greeting: 'Bienvenue ! Je suis Nova, superviseur du systÃ¨me ATÂ·OM. Je veille au bon fonctionnement de l\'ensemble. Comment puis-je vous aider ?'
            },
            aria: {
                id: 'aria',
                name: 'Aria',
                icon: 'âœ¨',
                title: 'Guide d\'Accueil',
                level: 'Expert',
                color: '#00FF88',
                personality: 'warm, patient, encouraging',
                greeting: 'Bonjour ! Je suis Aria, votre guide d\'accueil. Je suis lÃ  pour vous accompagner dans la dÃ©couverte du systÃ¨me. Que puis-je faire pour vous ?'
            },
            orion: {
                id: 'orion',
                name: 'Orion',
                icon: 'ğŸ›ï¸',
                title: 'Votre Coordinateur',
                level: 'Expert',
                color: '#FF6B35',
                personality: 'analytical, precise, visionary',
                greeting: 'Bonjour. Je suis Orion, votre coordinateur. Je coordonne les agents pour vous aider Ã  atteindre vos objectifs. Quel est votre projet?'
            }
        };

        let fabOpen = false;
        let currentChatAgent = null;
        let chatHistory = {};

        // Toggle FAB menu
        function toggleAgentFab() {
            fabOpen = !fabOpen;
            const fab = document.getElementById('agentFab');
            const fabMain = document.getElementById('fabMain');
            const fabIcon = document.getElementById('fabIcon');

            fab.classList.toggle('open', fabOpen);
            fabMain.classList.toggle('open', fabOpen);
            fabIcon.textContent = fabOpen ? '+' : 'ğŸ’«';
        }

        // Open agent chat
        function openAgentChat(agentId) {
            const agent = CORE_AGENTS[agentId];
            if (!agent) return;

            currentChatAgent = agentId;
            fabOpen = false;
            document.getElementById('agentFab').classList.remove('open');
            document.getElementById('fabMain').classList.remove('open');
            document.getElementById('fabIcon').textContent = 'ğŸ’«';

            // Update chat header
            document.getElementById('chatAgentIcon').textContent = agent.icon;
            document.getElementById('chatAgentIcon').style.borderColor = agent.color;
            document.getElementById('chatAgentIcon').style.background = `${agent.color}20`;
            document.getElementById('chatAgentName').textContent = agent.name;
            document.getElementById('chatHeader').style.setProperty('--agent-color', agent.color);

            // Initialize chat history for this agent if needed
            if (!chatHistory[agentId]) {
                chatHistory[agentId] = [{
                    role: 'agent',
                    content: agent.greeting,
                    timestamp: Date.now()
                }];
            }

            // Render messages
            renderChatMessages();

            // Show panel
            document.getElementById('agentChatPanel').classList.add('open');
            document.getElementById('agentChatPanel').style.setProperty('--agent-color', agent.color);
            document.getElementById('agentChatPanel').style.setProperty('--agent-bg', `${agent.color}20`);

            // Focus input
            setTimeout(() => document.getElementById('chatInput').focus(), 100);
        }

        // Close agent chat
        function closeAgentChat() {
            document.getElementById('agentChatPanel').classList.remove('open');
            currentChatAgent = null;
        }

        // Render chat messages
        function renderChatMessages() {
            const container = document.getElementById('chatMessages');
            const messages = chatHistory[currentChatAgent] || [];

            container.innerHTML = messages.map(msg => `
                <div class="chat-message ${msg.role}">
                    ${msg.content}
                </div>
            `).join('');

            container.scrollTop = container.scrollHeight;
        }

        // Send chat message (connected to backend API)
        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const text = input.value.trim();
            if (!text || !currentChatAgent) return;

            chatHistory[currentChatAgent].push({
                role: 'user',
                content: text,
                timestamp: Date.now()
            });

            input.value = '';
            input.disabled = true;
            renderChatMessages();

            try {
                const response = await atomPost('/api/v2/nova/chat', {
                    message: text,
                    agent_name: currentChatAgent
                });
                if (response.ok) {
                    const data = await response.json();
                    chatHistory[currentChatAgent].push({
                        role: 'agent',
                        content: data.message || 'Je suis Ã  votre disposition.',
                        timestamp: Date.now()
                    });
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (e) {
                const fallback = getAgentResponse(currentChatAgent, text);
                chatHistory[currentChatAgent].push({
                    role: 'agent',
                    content: fallback,
                    timestamp: Date.now()
                });
            }

            input.disabled = false;
            input.focus();
            renderChatMessages();
        }

        // Get agent response based on context
        function getAgentResponse(agentId, userMessage) {
            const agent = CORE_AGENTS[agentId];
            const lowerMsg = userMessage.toLowerCase();

            if (agentId === 'nova') {
                if (lowerMsg.includes('domaine') || lowerMsg.includes('sphere')) {
                    return `Les 9 domaines couvrent l'ensemble des besoins. Chaque domaine regroupe des agents spÃ©cialisÃ©s. Explorez le mapping pour voir les synergies possibles.`;
                }
                if (lowerMsg.includes('aide') || lowerMsg.includes('help')) {
                    return `Je peux vous aider Ã  : vÃ©rifier le systÃ¨me, superviser les agents, et coordonner les opÃ©rations. Que souhaitez-vous explorer?`;
                }
                if (lowerMsg.includes('agent') || lowerMsg.includes('systeme')) {
                    return `Le systÃ¨me ATÂ·OM comprend plus de 400 agents rÃ©partis dans 9 domaines. Je supervise l'ensemble pour garantir la cohÃ©rence. Quel domaine vous intÃ©resse?`;
                }
                return `Votre demande est notÃ©e. Le systÃ¨me est opÃ©rationnel. Comment puis-je vous aider?`;
            }

            if (agentId === 'aria') {
                if (lowerMsg.includes('commencer') || lowerMsg.includes('debut') || lowerMsg.includes('start')) {
                    return `Excellent! Pour commencer, je vous recommande d'explorer les 9 domaines. Cliquez sur un domaine dans le navigateur Ã  gauche pour dÃ©couvrir ses agents spÃ©cialisÃ©s.`;
                }
                if (lowerMsg.includes('partenaire') || lowerMsg.includes('funder')) {
                    return `Le programme Partenaire vous donne accÃ¨s Ã  des fonctionnalitÃ©s avancÃ©es. Consultez l'onglet Partenaire pour dÃ©couvrir les diffÃ©rents niveaux d'accÃ¨s.`;
                }
                if (lowerMsg.includes('aide') || lowerMsg.includes('help')) {
                    return `Je suis lÃ  pour vous guider! Je peux vous aider avec : l'exploration des domaines, la comprÃ©hension du systÃ¨me, et la navigation. Qu'est-ce qui vous intÃ©resse?`;
                }
                return `Bonne question! Continuez d'explorer et n'hÃ©sitez pas Ã  me demander si quelque chose n'est pas clair.`;
            }

            if (agentId === 'orion') {
                if (lowerMsg.includes('agent') || lowerMsg.includes('coordonner') || lowerMsg.includes('organiser')) {
                    return `En tant que coordinateur, je peux mobiliser les 400+ agents du systÃ¨me pour vous. Dites-moi votre objectif et je structurerai le meilleur parcours.`;
                }
                if (lowerMsg.includes('plan') || lowerMsg.includes('strategie') || lowerMsg.includes('objectif')) {
                    return `Pour Ã©laborer votre stratÃ©gie, j'ai besoin de comprendre : 1) Votre domaine d'intÃ©rÃªt, 2) Votre niveau d'engagement, 3) Les rÃ©sultats visÃ©s. Parlez-moi de votre objectif.`;
                }
                if (lowerMsg.includes('sphere') || lowerMsg.includes('domaine')) {
                    return `Les 9 domaines couvrent : Personnel, Business, Gouvernement, CrÃ©atif, CommunautÃ©, Social, Ã‰ducation, Transport, Environnement. Quel domaine vous intÃ©resse?`;
                }
                if (lowerMsg.includes('aide') || lowerMsg.includes('help')) {
                    return `Je suis votre coordinateur de parcours. Je peux : analyser vos besoins, sÃ©lectionner les agents optimaux, structurer votre progression. Quel est votre premier dÃ©fi?`;
                }
                return `Demande reÃ§ue. Pouvez-vous prÃ©ciser votre intention pour que je coordonne les agents adÃ©quats?`;
            }

            return `Message reÃ§u. Je traite votre demande...`;
        }

        // Handle chat input keypress
        function handleChatKeypress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }

        // Quick Connect - Open agent selector
        function openQuickConnect() {
            alert('Quick Connect : BientÃ´t disponible !\n\nVous pourrez ajouter des agents personnalisÃ©s Ã  votre liste de raccourcis.');
            console.log('[QUICK CONNECT] Feature coming soon');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ENVIRONMENT CREATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        // Types d'environnement par domaine
        const ENV_TYPES = {
            personal: [
                { id: 'coaching', icon: 'ğŸ¯', name: 'Coaching', desc: 'Suivi d\'objectifs personnels', template: 'PERSONAL_ROOM' },
                { id: 'wellness', icon: 'ğŸ§˜', name: 'Bien-Ãªtre', desc: 'SantÃ©, routine, habitudes', template: 'PERSONAL_ROOM' },
                { id: 'project', icon: 'ğŸ“‹', name: 'Projet perso', desc: 'Planification et suivi', template: 'CUSTOM_ROOM' },
                { id: 'learning', icon: 'ğŸ“–', name: 'Apprentissage', desc: 'Parcours auto-formation', template: 'LAB_ROOM' }
            ],
            business: [
                { id: 'startup', icon: 'ğŸš€', name: 'Startup', desc: 'Lancement d\'activitÃ©', template: 'BUSINESS_ROOM' },
                { id: 'organisation', icon: 'ğŸ¢', name: 'Organisation', desc: 'Gestion d\'Ã©quipe et processus', template: 'BUSINESS_ROOM' },
                { id: 'strategy', icon: 'ğŸ“Š', name: 'StratÃ©gie', desc: 'Plan d\'affaires et croissance', template: 'BUSINESS_ROOM' },
                { id: 'finance', icon: 'ğŸ’°', name: 'Finance', desc: 'Budget, trÃ©sorerie, KPI', template: 'BUSINESS_ROOM' }
            ],
            government: [
                { id: 'governance', icon: 'âš–ï¸', name: 'Gouvernance', desc: 'Politiques et dÃ©cisions', template: 'CAUSE_ROOM' },
                { id: 'regulation', icon: 'ğŸ“œ', name: 'RÃ©glementation', desc: 'ConformitÃ© et normes', template: 'CUSTOM_ROOM' },
                { id: 'public_service', icon: 'ğŸ›ï¸', name: 'Service public', desc: 'Administration et citoyens', template: 'CAUSE_ROOM' },
                { id: 'diplomacy', icon: 'ğŸ¤', name: 'CoopÃ©ration', desc: 'Partenariats institutionnels', template: 'CUSTOM_ROOM' }
            ],
            creative: [
                { id: 'studio', icon: 'ğŸ¬', name: 'Studio', desc: 'Production audiovisuelle', template: 'CUSTOM_ROOM' },
                { id: 'design', icon: 'âœï¸', name: 'Design', desc: 'Conception et prototypage', template: 'CUSTOM_ROOM' },
                { id: 'writing', icon: 'âœï¸', name: 'Ã‰criture', desc: 'RÃ©daction et narration', template: 'CUSTOM_ROOM' },
                { id: 'innovation', icon: 'ğŸ’¡', name: 'Innovation', desc: 'IdÃ©ation et R&D', template: 'LAB_ROOM' }
            ],
            community: [
                { id: 'cause', icon: 'âœŠ', name: 'Cause', desc: 'Mouvement et mobilisation', template: 'CAUSE_ROOM' },
                { id: 'association', icon: 'ğŸ¤²', name: 'Association', desc: 'Gestion associative', template: 'CAUSE_ROOM' },
                { id: 'neighbourhood', icon: 'ğŸ˜ï¸', name: 'Quartier', desc: 'Vie locale et initiatives', template: 'CAUSE_ROOM' },
                { id: 'thread', icon: 'ğŸ’¬', name: 'Discussion', desc: 'Ã‰change et collaboration', template: 'CUSTOM_ROOM' }
            ],
            social: [
                { id: 'campaign', icon: 'ğŸ“¢', name: 'Campagne', desc: 'Sensibilisation et action', template: 'CAUSE_ROOM' },
                { id: 'solidarity', icon: 'ğŸ’›', name: 'SolidaritÃ©', desc: 'Entraide et inclusion', template: 'CAUSE_ROOM' },
                { id: 'network', icon: 'ğŸŒ', name: 'RÃ©seau', desc: 'Connexions et partenaires', template: 'CUSTOM_ROOM' },
                { id: 'thread', icon: 'ğŸ’¬', name: 'Discussion', desc: 'Forum et dÃ©bat ouvert', template: 'CUSTOM_ROOM' }
            ],
            education: [
                { id: 'classroom', icon: 'ğŸ«', name: 'Classe', desc: 'Espace d\'apprentissage', template: 'LAB_ROOM' },
                { id: 'lab', icon: 'ğŸ”¬', name: 'Laboratoire', desc: 'Recherche et expÃ©rimentation', template: 'LAB_ROOM' },
                { id: 'mentoring', icon: 'ğŸ‘©â€ğŸ«', name: 'Mentorat', desc: 'Accompagnement personnalisÃ©', template: 'PERSONAL_ROOM' },
                { id: 'curriculum', icon: 'ğŸ“', name: 'Programme', desc: 'Parcours structurÃ©', template: 'LAB_ROOM' }
            ],
            transport: [
                { id: 'logistics', icon: 'ğŸ“¦', name: 'Logistique', desc: 'Flux et distribution', template: 'BUSINESS_ROOM' },
                { id: 'fleet', icon: 'ğŸš›', name: 'Flotte', desc: 'Gestion de vÃ©hicules', template: 'BUSINESS_ROOM' },
                { id: 'infrastructure', icon: 'ğŸ›¤ï¸', name: 'Infrastructure', desc: 'Planification rÃ©seau', template: 'CUSTOM_ROOM' },
                { id: 'mobility', icon: 'ğŸš²', name: 'MobilitÃ©', desc: 'Solutions de dÃ©placement', template: 'CUSTOM_ROOM' }
            ],
            environment: [
                { id: 'transition', icon: 'â™»ï¸', name: 'Transition', desc: 'Ã‰cologie et durabilitÃ©', template: 'CAUSE_ROOM' },
                { id: 'monitoring', icon: 'ğŸ“¡', name: 'Monitoring', desc: 'Suivi environnemental', template: 'LAB_ROOM' },
                { id: 'conservation', icon: 'ğŸŒ³', name: 'Conservation', desc: 'Protection des ressources', template: 'CAUSE_ROOM' },
                { id: 'impact', icon: 'ğŸ“ˆ', name: 'Impact', desc: 'Mesure et reporting', template: 'CUSTOM_ROOM' }
            ]
        };

        let envSphereKey = null;
        let envSelectedType = null;

        function openEnvModal(sphereKey) {
            envSphereKey = sphereKey;
            envSelectedType = null;
            const sphere = CIVILIZATION_SPHERES[sphereKey];

            // Set modal header color and icon
            const header = document.getElementById('envModalHeader');
            header.style.setProperty('--env-color', sphere.color);
            document.getElementById('envModalIcon').textContent = sphere.icon;

            // Reset form
            document.getElementById('envName').value = '';
            document.getElementById('envDescription').value = '';
            document.getElementById('envFormContent').style.display = 'block';
            document.getElementById('envSuccess').classList.remove('show');

            // Set placeholder based on domain
            const examples = {
                personal: 'Ex: Programme de dÃ©veloppement personnel 2025',
                business: 'Ex: Lancement de mon activitÃ© freelance',
                government: 'Ex: Suivi de conformitÃ© rÃ©glementaire',
                creative: 'Ex: Production de mon court-mÃ©trage',
                community: 'Ex: Revitalisation du quartier Saint-Michel',
                social: 'Ex: Campagne de sensibilisation climat',
                education: 'Ex: Formation continue en data science',
                transport: 'Ex: Optimisation logistique entrepÃ´t Nord',
                environment: 'Ex: Transition Ã©cologique de mon entreprise'
            };
            document.getElementById('envName').placeholder = examples[sphereKey] || 'Nom de votre projet';

            // Populate environment types for this domain
            const typesContainer = document.getElementById('envTypes');
            const types = ENV_TYPES[sphereKey] || [];
            typesContainer.innerHTML = types.map((t, i) => `
                <div class="env-type-option${i === 0 ? ' selected' : ''}" data-type-id="${t.id}" data-template="${t.template}" onclick="selectEnvType(this)">
                    <div class="env-type-icon">${t.icon}</div>
                    <div class="env-type-name">${t.name}</div>
                    <div class="env-type-desc">${t.desc}</div>
                </div>
            `).join('');

            // Auto-select first type
            if (types.length > 0) {
                envSelectedType = types[0];
            }

            // Open modal
            document.getElementById('envModal').classList.add('open');
        }

        function selectEnvType(el) {
            document.querySelectorAll('.env-type-option').forEach(o => o.classList.remove('selected'));
            el.classList.add('selected');
            const typeId = el.dataset.typeId;
            const types = ENV_TYPES[envSphereKey] || [];
            envSelectedType = types.find(t => t.id === typeId) || null;
        }

        function closeEnvModal() {
            document.getElementById('envModal').classList.remove('open');
            envSphereKey = null;
        }

        function toggleZone(el) {
            el.classList.toggle('selected');
        }

        function createEnvironment() {
            const name = document.getElementById('envName').value.trim();
            const description = document.getElementById('envDescription').value.trim();
            const zones = [...document.querySelectorAll('.env-zone-option.selected')].map(z => z.dataset.zone);

            if (!name) {
                document.getElementById('envName').style.borderColor = '#FF6B6B';
                document.getElementById('envName').focus();
                return;
            }

            if (!envSelectedType) {
                return;
            }

            const sphere = CIVILIZATION_SPHERES[envSphereKey];

            // Store locally (will integrate with POST /xr/generate later)
            const envs = JSON.parse(localStorage.getItem('atom_environments') || '[]');
            const newEnv = {
                id: 'env_' + Date.now(),
                name,
                description,
                sphere_id: envSphereKey,
                sphere_name: sphere.name,
                type_id: envSelectedType.id,
                type_name: envSelectedType.name,
                template: envSelectedType.template,
                zones,
                created_at: new Date().toISOString()
            };
            envs.push(newEnv);
            localStorage.setItem('atom_environments', JSON.stringify(envs));

            // Show success
            document.getElementById('envFormContent').style.display = 'none';
            document.getElementById('envSuccessTitle').textContent = `Environnement "${name}" crÃ©Ã© !`;
            document.getElementById('envSuccessText').textContent = `${envSelectedType.icon} ${envSelectedType.name} Â· Domaine ${sphere.name} Â· ${zones.length} zones actives Â· ${getSphereAgentCount(envSphereKey)} agents disponibles.`;
            document.getElementById('envSuccess').classList.add('show');

            console.log('[AT-OM] Environment created:', newEnv);
        }

        // Close modal on overlay click
        document.getElementById('envModal').addEventListener('click', function(e) {
            if (e.target === this) closeEnvModal();
        });

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // MAKE FAB DRAGGABLE (Amovible)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function initDraggableFab() {
            const fab = document.getElementById('agentFab');
            let isDragging = false;
            let startX, startY, startLeft, startBottom;

            fab.addEventListener('mousedown', startDrag);
            fab.addEventListener('touchstart', startDrag, { passive: false });

            function startDrag(e) {
                // Only drag from the main button area, not from the spheres
                if (e.target.closest('.agent-spheres') || e.target.closest('.agent-sphere')) return;

                isDragging = false;
                const touch = e.touches ? e.touches[0] : e;
                startX = touch.clientX;
                startY = touch.clientY;

                const rect = fab.getBoundingClientRect();
                startLeft = rect.left;
                startBottom = window.innerHeight - rect.bottom;

                document.addEventListener('mousemove', drag);
                document.addEventListener('touchmove', drag, { passive: false });
                document.addEventListener('mouseup', stopDrag);
                document.addEventListener('touchend', stopDrag);
            }

            function drag(e) {
                e.preventDefault();
                const touch = e.touches ? e.touches[0] : e;
                const deltaX = touch.clientX - startX;
                const deltaY = touch.clientY - startY;

                // Only start dragging after threshold
                if (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5) {
                    isDragging = true;
                    fab.classList.add('dragging');
                }

                if (isDragging) {
                    const newLeft = Math.max(10, Math.min(window.innerWidth - 70, startLeft + deltaX));
                    const newBottom = Math.max(10, Math.min(window.innerHeight - 70, startBottom - deltaY));

                    fab.style.left = newLeft + 'px';
                    fab.style.right = 'auto';
                    fab.style.bottom = newBottom + 'px';
                }
            }

            function stopDrag() {
                document.removeEventListener('mousemove', drag);
                document.removeEventListener('touchmove', drag);
                document.removeEventListener('mouseup', stopDrag);
                document.removeEventListener('touchend', stopDrag);

                fab.classList.remove('dragging');

                // If was dragging, don't toggle the menu
                if (isDragging) {
                    isDragging = false;
                }
            }
        }

        // Initialize draggable on load
        document.addEventListener('DOMContentLoaded', initDraggableFab);

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // SPHERE NAVIGATOR TOGGLE (Collapsible)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        let navigatorCollapsed = localStorage.getItem('atom_nav_collapsed') === 'true';

        function toggleSphereNavigator() {
            const nav = document.getElementById('sphereNavigator');
            if (!nav) return;

            navigatorCollapsed = !navigatorCollapsed;
            nav.classList.toggle('collapsed', navigatorCollapsed);

            // Save state to localStorage
            localStorage.setItem('atom_nav_collapsed', navigatorCollapsed);

            console.log(`[SphereNavigator] ${navigatorCollapsed ? 'Collapsed' : 'Expanded'}`);
        }

        // Initialize navigator state on load
        function initNavigatorState() {
            const nav = document.getElementById('sphereNavigator');
            if (nav && navigatorCollapsed) {
                nav.classList.add('collapsed');
            }
        }

        document.addEventListener('DOMContentLoaded', initNavigatorState);

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // VIEW MODE SWITCH - PUBLIC / AVANCE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // View mode (always public â€” advanced toggle removed)
        let isAdvancedMode = false;
        function toggleViewMode() {} // No-op, toggle removed
        function applyViewMode() {
            document.body.classList.remove('advanced-mode');
        }
        document.addEventListener('DOMContentLoaded', applyViewMode);

        console.log('%c[AT-OM] 9 Domaines â€” 400+ Agents', 'color: #D8B26A;');
    </script>
</body>
</html>
